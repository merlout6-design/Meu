<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Fritzza - Delivery</title>
    
    <!-- React & ReactDOM -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Chewy&display=swap" rel="stylesheet">

    <style>
        body { font-family: 'Poppins', sans-serif; background-color: #f8fafc; -webkit-tap-highlight-color: transparent; }
        .font-chewy { font-family: 'Chewy', cursive; }
        .hide-scrollbar::-webkit-scrollbar { display: none; }
        
        /* Animations */
        @keyframes float { 0% { transform: translateY(0px); } 50% { transform: translateY(-5px); } 100% { transform: translateY(0px); } }
        .animate-float { animation: float 3s ease-in-out infinite; }
        
        /* Toast Animation */
        .toast-enter { animation: toastIn 0.4s cubic-bezier(0.68, -0.55, 0.27, 1.55) forwards; }
        @keyframes toastIn { from { transform: translate(-50%, -100%); opacity: 0; } to { transform: translate(-50%, 20px); opacity: 1; } }
        
        /* Bag Animations */
        .bag-container { transform-origin: bottom center; transition: transform 0.1s; }
        .bag-jump { animation: bagJump 0.6s ease-in-out; }
        @keyframes bagJump {
            0% { transform: translateY(0) scale(1); }
            30% { transform: translateY(-15px) scale(1.15) rotate(-5deg); }
            50% { transform: translateY(-15px) scale(1.15) rotate(5deg); }
            70% { transform: translateY(0) scale(1.05); }
            100% { transform: translateY(0) scale(1); }
        }
        .bag-handle { transform-origin: 50% 100%; transition: transform 0.2s; }
        .bag-jump .bag-handle { animation: handleOpen 0.6s ease-in-out; }
        @keyframes handleOpen { 0% { transform: scaleY(1); } 30% { transform: scaleY(0.5) translateY(5px); } 70% { transform: scaleY(1); } }

        /* Custom UI */
        .glass-panel { background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.5); }
        .product-card { transition: all 0.2s cubic-bezier(0.25, 0.8, 0.25, 1); }
        .product-card:active { transform: scale(0.98); }
        .flying-img { position: fixed; z-index: 10000; pointer-events: none; border-radius: 50%; box-shadow: 0 5px 15px rgba(0,0,0,0.2); transition: all 0.6s cubic-bezier(0.5, 0.05, 0.5, 0.95); }
        .step-line { position: absolute; left: 24px; top: 0; bottom: 0; width: 2px; background: #e2e8f0; z-index: 0; }
        .step-item { position: relative; z-index: 1; }
        
        /* Modal */
        .modal-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.5); backdrop-filter: blur(3px); display: flex; align-items: center; justify-content: center; z-index: 9999; animation: fadeIn 0.2s; }
        .modal-box { background: white; padding: 25px; border-radius: 20px; width: 90%; max-width: 350px; text-align: center; box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1); animation: popIn 0.3s cubic-bezier(0.34, 1.56, 0.64, 1); }
        @keyframes popIn { from { transform: scale(0.8) translateY(20px); opacity: 0; } to { transform: scale(1) translateY(0); opacity: 1; } }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        .loader { width: 48px; height: 48px; border: 5px solid #FFF; border-bottom-color: transparent; border-radius: 50%; display: inline-block; box-sizing: border-box; animation: rotation 1s linear infinite; }
        @keyframes rotation { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        // --- CONFIGURA√á√ÉO FIREBASE ---
        const firebaseConfig = {
            apiKey: "AIzaSyAg2kfoWsvWWyEXQGe8v6jZZqKepgButUk",
            authDomain: "ajuda-2217b.firebaseapp.com",
            projectId: "ajuda-2217b",
            storageBucket: "ajuda-2217b.firebasestorage.app",
            messagingSenderId: "421083897636",
            appId: "1:421083897636:web:18bd6097b5c0169427ddb1"
        };

        if (!firebase.apps.length) { try { firebase.initializeApp(firebaseConfig); } catch (e) {} }
        const auth = firebase.auth();
        const db = firebase.firestore();
        const APP_ID = "ajuda-2217b"; 
        const getCol = (n) => db.collection('artifacts').doc(APP_ID).collection('public').doc('data').collection(n);

        const { useState, useEffect, useMemo, useRef } = React;
        const formatMoney = (v) => v.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' });
        const DEFAULT_COORDS = { lat: -25.0015570, lng: -53.4628300 };

        // --- UTILIT√ÅRIOS ---
        const isStoreOpen = (start, end) => {
            if(!start || !end) return true; 
            const now = new Date();
            const current = now.getHours() * 60 + now.getMinutes();
            const [sH, sM] = start.split(':').map(Number);
            const [eH, eM] = end.split(':').map(Number);
            const startMin = sH * 60 + sM;
            const endMin = eH * 60 + eM;
            if (endMin < startMin) return current >= startMin || current <= endMin;
            else return current >= startMin && current <= endMin;
        };

        // --- COMPONENTES UI ---
        const GlobalModal = ({ modal, close }) => {
            if (!modal.isOpen) return null;
            return (
                <div className="modal-overlay" onClick={modal.type === 'alert' ? close : undefined}>
                    <div className="modal-box" onClick={e => e.stopPropagation()}>
                        {modal.type === 'loading' ? (
                            <div className="py-4">
                                <div className="loader border-blue-500 border-b-transparent mb-4 mx-auto" style={{borderColor: modal.color || '#3b82f6', borderBottomColor: 'transparent'}}></div>
                                <h3 className="text-lg font-bold text-gray-800">{modal.title}</h3>
                            </div>
                        ) : (
                            <>
                                <div className={`text-5xl mb-4 ${modal.type === 'error' ? 'text-red-500' : modal.type === 'success' ? 'text-green-500' : 'text-blue-500'}`}>
                                    {modal.icon ? <i className={modal.icon}></i> : modal.type === 'error' ? <i className="fa-regular fa-circle-xmark"></i> : modal.type === 'success' ? <i className="fa-regular fa-circle-check"></i> : <i className="fa-solid fa-circle-info"></i>}
                                </div>
                                <h3 className="text-xl font-bold text-gray-800 mb-2">{modal.title}</h3>
                                <p className="text-gray-500 text-sm mb-6 px-2">{modal.message}</p>
                                <div className="flex gap-3">
                                    {modal.type === 'confirm' && <button onClick={close} className="flex-1 py-3 border border-gray-200 rounded-xl text-gray-600 font-bold hover:bg-gray-50 transition">Cancelar</button>}
                                    <button onClick={() => { if(modal.onConfirm) modal.onConfirm(); close(); }} className={`flex-1 py-3 rounded-xl text-white font-bold shadow-lg transform active:scale-95 transition ${modal.type === 'error' ? 'bg-red-500' : 'bg-blue-600'}`} style={modal.confirmStyle}>{modal.confirmText || 'OK'}</button>
                                </div>
                            </>
                        )}
                    </div>
                </div>
            );
        };

        const Toast = ({ msg }) => {
            if (!msg) return null;
            return (
                <div className="fixed top-0 left-1/2 bg-gray-900/95 backdrop-blur text-white px-6 py-3 rounded-full shadow-2xl z-[10000] flex items-center gap-3 toast-enter border border-white/10">
                    <div className="bg-green-500 rounded-full p-1"><i className="fa-solid fa-check text-xs"></i></div>
                    <span className="font-medium text-sm">{msg}</span>
                </div>
            );
        };

        const MagicBag = ({ count, isAnimating, color }) => (
            <div className={`bag-container relative w-10 h-10 ${isAnimating ? 'bag-jump' : ''}`}>
                <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" className="w-full h-full drop-shadow-md">
                    <path className="bag-handle" d="M8 7V5C8 3.34315 9.34315 2 11 2H13C14.6569 2 16 3.34315 16 5V7" stroke={color} strokeWidth="2" strokeLinecap="round" />
                    <path d="M5 7H19L20 21H4L5 7Z" fill="white" stroke={color} strokeWidth="2" strokeLinejoin="round" />
                    <path d="M9 11C9 11 10 12 12 12C14 12 15 11 15 11" stroke={color} strokeWidth="1.5" strokeLinecap="round" opacity="0.3" />
                </svg>
                <div className="absolute top-[10px] left-0 right-0 flex justify-center items-center">
                    <span className="text-[10px] font-bold text-gray-800 leading-none">{count}</span>
                </div>
            </div>
        );

        // --- APP PRINCIPAL ---
        const App = () => {
            const [view, setView] = useState("menu");
            const [activeOrder, setActiveOrder] = useState(null); 
            const [cart, setCart] = useState(() => { try { return JSON.parse(localStorage.getItem('fritzza_cart')) || []; } catch(e) { return []; } });
            
            const [modal, setModal] = useState({ isOpen: false, type: 'alert' });
            const [toast, setToast] = useState(null);
            const toastTimeoutRef = useRef(null);
            const [bagAnim, setBagAnim] = useState(false);
            
            const [products, setProducts] = useState([]);
            const [categories, setCategories] = useState([]);
            const [neighborhoods, setNeighborhoods] = useState([]);
            const [settings, setSettings] = useState({ appName: "Fritzza", themeColor: "#dc2626", openTime: "18:00", closeTime: "23:00", cardStyle: "grid", borderRadius: "rounded-2xl", restLat: DEFAULT_COORDS.lat, restLng: DEFAULT_COORDS.lng, pricePerKm: 2.00, whatsappNumber: "5545988166885" });
            const [loading, setLoading] = useState(true);

            const showAlert = (title, message, type='alert', icon=null) => setModal({ isOpen: true, type, title, message, icon });
            const showConfirm = (title, message, onConfirm) => setModal({ isOpen: true, type: 'confirm', title, message, onConfirm });
            const showLoading = (title='Carregando...') => setModal({ isOpen: true, type: 'loading', title, color: settings.themeColor });
            const closeModal = () => setModal({ ...modal, isOpen: false });
            
            const showToast = (msg) => { 
                if (toastTimeoutRef.current) clearTimeout(toastTimeoutRef.current);
                setToast(null); setTimeout(() => { setToast(msg); toastTimeoutRef.current = setTimeout(() => setToast(null), 3000); }, 50);
            };

            useEffect(() => { localStorage.setItem('fritzza_cart', JSON.stringify(cart)); }, [cart]);

            useEffect(() => {
                const init = async () => {
                    if (!auth.currentUser) await auth.signInAnonymously();
                    const root = db.collection('artifacts').doc(APP_ID).collection('public').doc('data');
                    
                    // DETECTAR LINK DE RASTREIO NA URL
                    const urlParams = new URLSearchParams(window.location.search);
                    const orderParam = urlParams.get('order');
                    if (orderParam) {
                        setActiveOrder(orderParam);
                        setView("status");
                        setLoading(false);
                        return;
                    }

                    root.collection('config').doc('main').onSnapshot(d => { 
                        if (d.exists) { 
                            const data = d.data();
                            setSettings(prev => ({...prev, ...data})); 
                            if(data.bgColor) document.body.style.backgroundColor = data.bgColor; 
                        } 
                    });
                    root.collection('categories').orderBy('order').onSnapshot(s => setCategories(s.docs.map(d => ({ id: d.id, ...d.data() }))));
                    root.collection('products').onSnapshot(s => setProducts(s.docs.map(d => ({ id: d.id, ...d.data() }))));
                    root.collection('neighborhoods').onSnapshot(s => setNeighborhoods(s.docs.map(d => ({ id: d.id, ...d.data() }))));
                    
                    const savedOrderId = localStorage.getItem('fritzza_last_order');
                    if (savedOrderId) {
                        const savedOrderDate = localStorage.getItem('fritzza_last_order_date');
                        const isRecent = savedOrderDate && (new Date() - new Date(savedOrderDate)) < 86400000;
                        if(isRecent) setActiveOrder(savedOrderId);
                    }
                    setLoading(false);
                };
                init();
            }, []);

            const addToCart = (p, e) => {
                showToast(`${p.name} adicionado!`);
                const performUpdate = () => {
                    setCart(prev => {
                        const exists = prev.find(i => i.id === p.id);
                        if (exists) return prev.map(i => i.id === p.id ? { ...i, quantity: i.quantity + 1 } : i);
                        return [...prev, { ...p, quantity: 1 }];
                    });
                };

                if(e) {
                    setBagAnim(true);
                    setTimeout(() => setBagAnim(false), 600);
                    const card = e.currentTarget.closest('.product-card');
                    const img = card ? card.querySelector('img') : null;
                    const rect = img ? img.getBoundingClientRect() : card.getBoundingClientRect();
                    const clone = img ? img.cloneNode(true) : document.createElement('div');
                    if(!img) { clone.style.backgroundColor = settings.themeColor; clone.style.borderRadius = '50%'; }
                    clone.style.cssText = `position:fixed;left:${rect.left}px;top:${rect.top}px;width:${rect.width}px;height:${rect.height}px;z-index:10000;border-radius:50%;pointer-events:none;transition:all 0.5s cubic-bezier(0.5,0.05,0.5,0.95);box-shadow:0 10px 25px rgba(0,0,0,0.3);object-fit:cover;`;
                    clone.className = 'flying-img';
                    document.body.appendChild(clone);

                    const bagElement = document.querySelector('.bag-container');
                    let destX, destY;
                    if(bagElement) {
                        const dest = bagElement.getBoundingClientRect();
                        destX = dest.left + (dest.width / 2) - 15; destY = dest.top - 10;
                    } else {
                        destX = window.innerWidth / 2 - 15; destY = window.innerHeight - 90; 
                    }
                    clone.getBoundingClientRect();
                    setTimeout(() => { clone.style.left = destX + 'px'; clone.style.top = destY + 'px'; clone.style.width = '30px'; clone.style.height = '30px'; clone.style.transform = 'scale(0.8)'; }, 10);
                    setTimeout(() => { clone.style.opacity = '0'; clone.style.transform = 'scale(0.2) translateY(10px)'; performUpdate(); setTimeout(() => clone.remove(), 100); }, 500);
                } else { performUpdate(); }
            };

            const handleOrderCreated = (orderId) => {
                setActiveOrder(orderId);
                localStorage.setItem('fritzza_last_order', orderId);
                localStorage.setItem('fritzza_last_order_date', new Date().toISOString());
                setCart([]);
                setView("status");
                
                // Atualiza URL sem recarregar para salvar estado de rastreio se o user der refresh
                const newUrl = window.location.protocol + "//" + window.location.host + window.location.pathname + '?order=' + orderId;
                window.history.pushState({path:newUrl},'',newUrl);
            };

            const themeStyle = { backgroundColor: settings.themeColor || '#dc2626' };
            const borderStyle = settings.borderRadius || 'rounded-2xl'; 

            if (loading) return <div className="h-screen flex flex-col items-center justify-center text-gray-400 bg-gray-50"><div className="loader border-gray-400 border-b-transparent mb-4"></div><p>Carregando...</p></div>;

            return (
                <div className="min-h-screen pb-24 relative overflow-hidden">
                    <GlobalModal modal={modal} close={closeModal} />
                    <Toast msg={toast} />
                    {view !== 'status' && (
                        <header className="sticky top-0 z-40 transition-all duration-300">
                            <div className={`relative overflow-hidden pt-4 pb-12 px-4 shadow-lg ${settings.borderRadius === 'rounded-none' ? '' : 'rounded-b-[2rem]'}`} style={themeStyle}>
                                {settings.bannerUrl ? <div className="absolute inset-0 z-0"><img src={settings.bannerUrl} className="w-full h-full object-cover opacity-50" /></div> : <div className="absolute inset-0 opacity-10 bg-[url('https://www.transparenttextures.com/patterns/food.png')]"></div>}
                                <div className="relative z-10 flex justify-between items-center">
                                    <div className="flex items-center gap-3 text-white">
                                        {settings.logoStyle !== 'none' && (
                                            <div className={`flex items-center justify-center ${settings.logoStyle === 'raw' ? '' : 'w-14 h-14 bg-white/20 backdrop-blur border-2 border-white/30 shadow-inner'} ${settings.logoStyle==='circle'?'rounded-full':(settings.logoStyle==='square' ? 'rounded-lg' : '')}`}>
                                                {settings.logoUrl ? <img src={settings.logoUrl} className={`${settings.logoStyle === 'raw' ? 'w-16 h-16 object-contain' : 'w-full h-full object-cover'} ${settings.logoStyle==='circle'?'rounded-full':(settings.logoStyle==='square' ? 'rounded-lg' : '')}`} /> : <span className="font-chewy text-2xl">{settings.appName?.[0]}</span>}
                                            </div>
                                        )}
                                        <div>
                                            <h1 className="font-chewy text-3xl leading-none drop-shadow-md" style={{color: settings.appNameColor || '#fff'}}>{settings.appName}</h1>
                                            <p className="text-white/90 text-xs font-medium tracking-wide drop-shadow-sm">{settings.appSubtitle}</p>
                                        </div>
                                    </div>
                                    <button onClick={()=>window.location.href='acompanhar.html'} className="bg-white/20 backdrop-blur text-white px-3 py-1.5 rounded-full text-xs font-bold border border-white/30 hover:bg-white/30 transition">
                                        <i className="fa-solid fa-motorcycle mr-1"></i> Pedidos
                                    </button>
                                </div>
                                {settings.headerPhrase && <div className="relative z-10 mt-3 text-center"><div className="inline-block bg-black/20 backdrop-blur-sm px-4 py-1 rounded-full text-xs text-white font-medium border border-white/10 shadow-sm"><i className="fa-solid fa-bullhorn mr-1 text-yellow-300"></i> {settings.headerPhrase}</div></div>}
                            </div>
                        </header>
                    )}

                    <main className={`container mx-auto max-w-lg ${view === 'menu' ? '-mt-8' : ''} relative z-20 px-4`}>
                        {view === "menu" && <MenuView products={products} categories={categories} addToCart={addToCart} settings={settings} theme={themeStyle} border={borderStyle} />}
                        {view === "checkout" && <CheckoutView cart={cart} setCart={setCart} settings={settings} neighborhoods={neighborhoods} products={products} onBack={()=>setView("menu")} onCreated={handleOrderCreated} showAlert={showAlert} showConfirm={showConfirm} showLoading={showLoading} closeModal={closeModal} theme={themeStyle} border={borderStyle} />}
                        {view === "status" && <OrderStatusView orderId={activeOrder} onBack={()=>setView("menu")} theme={themeStyle} border={borderStyle} />}
                    </main>

                    {view === "menu" && cart.length > 0 && (
                        <div className="fixed bottom-6 left-0 right-0 px-4 z-50 flex justify-center">
                            <button id="cart-fab-btn" onClick={()=>setView("checkout")} className={`w-full max-w-lg p-3 shadow-2xl flex items-center justify-between transform transition hover:scale-[1.02] active:scale-95 text-white ${borderStyle}`} style={{backgroundColor: settings.cartColor || '#16a34a'}}>
                                <div className="flex items-center gap-4">
                                    <MagicBag count={cart.reduce((a,b)=>a+b.quantity,0)} isAnimating={bagAnim} color={settings.cartColor ? '#15803d' : '#16a34a'} />
                                    <div className="text-left border-l border-white/20 pl-4">
                                        <div className="text-xs opacity-90 font-medium">Meu Carrinho</div>
                                        <div className="font-bold text-lg leading-none">{formatMoney(cart.reduce((a,b)=>a+(b.price*b.quantity),0))}</div>
                                    </div>
                                </div>
                                <div className="flex items-center gap-2 font-bold text-sm bg-black/20 px-4 py-2 rounded-xl">Finalizar <i className="fa-solid fa-arrow-right"></i></div>
                            </button>
                        </div>
                    )}
                </div>
            );
        };

        const MenuView = ({ products, categories, addToCart, settings, theme, border }) => {
            const [search, setSearch] = useState("");
            const [catSel, setCatSel] = useState("Todas");
            const isOpen = isStoreOpen(settings.openTime, settings.closeTime);
            
            const filteredProducts = useMemo(() => {
                let list = products;
                if (search) list = list.filter(p => p.name.toLowerCase().includes(search.toLowerCase()) || p.description?.toLowerCase().includes(search.toLowerCase()));
                if (catSel !== "Todas") list = list.filter(p => p.category === catSel);
                return list;
            }, [products, search, catSel]);

            return (
                <div className="pb-10">
                    <div className={`bg-white shadow-lg p-4 mb-6 glass-panel ${border}`}>
                        <div className={`flex items-center justify-center gap-2 text-sm font-bold mb-4 ${isOpen ? 'text-green-600' : 'text-red-500'}`}>
                            <div className={`w-2 h-2 rounded-full ${isOpen ? 'bg-green-500 animate-pulse' : 'bg-red-500'}`}></div>
                            {isOpen ? "Aberto agora" : `Fechado ‚Ä¢ Abre √†s ${settings.openTime}`}
                        </div>
                        <div className="relative">
                            <i className="fa-solid fa-magnifying-glass absolute left-4 top-1/2 -translate-y-1/2 text-gray-400"></i>
                            <input type="text" placeholder="Buscar..." className={`w-full bg-gray-100 border-none py-3 pl-10 pr-4 text-gray-700 focus:ring-2 focus:ring-opacity-50 outline-none transition ${border}`} style={{'--tw-ring-color': settings.themeColor}} value={search} onChange={e=>setSearch(e.target.value)} />
                        </div>
                    </div>
                    <div className="flex gap-2 overflow-x-auto pb-4 hide-scrollbar mb-2 sticky top-20 z-30 py-2 -mx-4 px-4 bg-gradient-to-b from-[#f8fafc] to-transparent">
                        <button onClick={()=>setCatSel("Todas")} className={`px-4 py-2 text-sm font-bold whitespace-nowrap transition shadow-sm ${catSel==="Todas" ? 'text-white shadow-md transform scale-105' : 'bg-white text-gray-500 border border-gray-100'} ${border}`} style={catSel==="Todas"?theme:{}}>Todas</button>
                        {categories.map(c => (<button key={c.id} onClick={()=>setCatSel(c.name)} className={`px-4 py-2 text-sm font-bold whitespace-nowrap transition shadow-sm ${catSel===c.name ? 'text-white shadow-md transform scale-105' : 'bg-white text-gray-500 border border-gray-100'} ${border}`} style={catSel===c.name?theme:{}}>{c.name}</button>))}
                    </div>
                    <div className={`space-y-6 ${settings.cardStyle === 'grid' ? '' : 'max-w-md mx-auto'}`}>
                        {filteredProducts.length === 0 ? <div className="text-center py-10 opacity-50"><p>Nenhum produto encontrado.</p></div> : 
                        catSel === "Todas" && !search ? categories.map(cat => {
                            const prods = filteredProducts.filter(p => p.category === cat.name);
                            if(prods.length === 0) return null;
                            return <div key={cat.id}><h2 className="font-bold text-lg text-gray-800 mb-3 flex items-center gap-2"><span className="w-1 h-6 rounded-full" style={theme}></span> {cat.name}</h2><div className={`grid gap-4 ${settings.cardStyle === 'grid' ? 'grid-cols-1' : 'grid-cols-1'}`}>{prods.map(p => <ProductCard key={p.id} p={p} addToCart={addToCart} theme={theme} border={border} styleType={settings.cardStyle} />)}</div></div>;
                        }) : <div className={`grid gap-4 ${settings.cardStyle === 'grid' ? 'grid-cols-1' : 'grid-cols-1'}`}>{filteredProducts.map(p => <ProductCard key={p.id} p={p} addToCart={addToCart} theme={theme} border={border} styleType={settings.cardStyle} />)}</div>}
                    </div>
                </div>
            );
        };

        const ProductCard = ({ p, addToCart, theme, border, styleType }) => {
            if (styleType === 'minimal') {
                return (
                    <div className={`bg-white p-4 shadow-sm border border-gray-100 flex justify-between items-center group hover:shadow-md transition ${border} product-card`}>
                        <div className="flex-1 pr-4">
                            <h3 className="font-bold text-gray-800 leading-tight mb-1">{p.name}</h3>
                            <p className="text-xs text-gray-500 line-clamp-1">{p.description}</p>
                            <span className="font-bold text-sm text-gray-800 mt-1 block">{formatMoney(p.price)}</span>
                        </div>
                        <button onClick={(e) => addToCart(p, e)} className="w-8 h-8 rounded-full text-white shadow flex items-center justify-center active:scale-90 transition" style={theme}><i className="fa-solid fa-plus text-xs"></i></button>
                    </div>
                );
            }
            if (styleType === 'list') {
                return (
                    <div className={`bg-white p-3 shadow-sm border border-gray-100 flex gap-3 relative group hover:shadow-md transition ${border} product-card`}>
                        {p.imageUrl && <div className={`w-20 h-20 bg-gray-100 flex-shrink-0 relative overflow-hidden ${border}`}><img src={p.imageUrl} className="w-full h-full object-cover" /></div>}
                        <div className="flex-1 flex flex-col justify-between py-1">
                            <div><h3 className="font-bold text-gray-800 leading-tight mb-1">{p.name}</h3><p className="text-xs text-gray-500 line-clamp-2">{p.description}</p></div>
                            <div className="flex justify-between items-end mt-2"><span className="font-bold text-gray-800">{formatMoney(p.price)}</span><button onClick={(e) => addToCart(p, e)} className="w-7 h-7 rounded-full text-white shadow flex items-center justify-center active:scale-90 transition" style={theme}><i className="fa-solid fa-plus text-xs"></i></button></div>
                        </div>
                    </div>
                );
            }
            return (
                <div className={`bg-white p-3 shadow-sm border border-gray-100 flex gap-4 overflow-hidden relative group hover:shadow-md transition ${border} product-card`}>
                    <div className={`w-28 h-28 bg-gray-100 flex-shrink-0 relative overflow-hidden ${border}`}>
                        {p.imageUrl ? <img src={p.imageUrl} className="w-full h-full object-cover transition duration-500 group-hover:scale-110" /> : <div className="w-full h-full flex items-center justify-center text-gray-300"><i className="fa-solid fa-utensils text-2xl"></i></div>}
                    </div>
                    <div className="flex-1 flex flex-col justify-between py-1">
                        <div><h3 className="font-bold text-gray-800 leading-tight mb-1 line-clamp-2">{p.name}</h3><p className="text-xs text-gray-500 line-clamp-2 leading-relaxed">{p.description}</p></div>
                        <div className="flex justify-between items-end mt-2"><span className="font-bold text-lg text-gray-800">{formatMoney(p.price)}</span><button onClick={(e) => addToCart(p, e)} className="w-8 h-8 rounded-full text-white shadow-lg flex items-center justify-center active:scale-90 transition" style={theme}><i className="fa-solid fa-plus text-xs"></i></button></div>
                    </div>
                </div>
            );
        };

        const CheckoutView = ({ cart, setCart, settings, neighborhoods, products, onBack, onCreated, showAlert, showConfirm, showLoading, closeModal, theme, border }) => {
            const [form, setForm] = useState({ name: "", phone: "", cep: "", address: "", number: "", bairro: "", complement: "" });
            const [del, setDel] = useState({ fee: 0, km: 0, loading: false, lat: null, lon: null, method: 'pendente' });
            const [payMethod, setPayMethod] = useState("");
            const [change, setChange] = useState("");
            const [couponCode, setCouponCode] = useState("");
            const [appliedCoupon, setAppliedCoupon] = useState(null);
            const [typingTimer, setTypingTimer] = useState(null);
            const [cepLoading, setCepLoading] = useState(false);
            const [pixData, setPixData] = useState(null);

            const totalItems = cart.reduce((a,b)=>a+(b.price*b.quantity),0);
            
            const handlePhoneChange = (e) => {
                let v = e.target.value.replace(/\D/g,'').slice(0,11);
                setForm(p => ({...p, phone: v}));
                if(v.length === 11) check(v);
            };

            const check = async (phoneValue) => {
                const clean = (phoneValue || form.phone).replace(/\D/g, '');
                if(clean.length < 8) return;
                try {
                    const snap = await getCol('customers').where('phoneRaw','==',clean).limit(1).get();
                    if(!snap.empty) {
                        const d = snap.docs[0].data();
                        setForm(p => ({
                            ...p, 
                            name: d.name || "", 
                            cep: d.cep || "", 
                            number: d.number || "", 
                            complement: d.complement || "",
                            address: d.address || "", 
                            bairro: d.bairro || "" 
                        }));
                        if(d.cep) fetchCep(d.cep, false); 
                    }
                } catch(e) {}
            };

            const handleCepChange = (e) => {
                let val = e.target.value.replace(/\D/g, '');
                if (val.length > 8) val = val.slice(0, 8);
                setForm(p => ({ ...p, cep: val }));
                if (val.length === 8) fetchCep(val, true);
            };

            const fetchCep = async (cep, autoFocusNumber) => {
                setCepLoading(true);
                try { 
                    const res = await fetch(`https://viacep.com.br/ws/${cep}/json/`); 
                    const data = await res.json(); 
                    if(!data.erro) { 
                        if(data.localidade !== 'Cascavel') { showAlert("Aten√ß√£o", "Entrega apenas em Cascavel/PR", "error"); return; }
                        setForm(p=>({...p, address: data.logradouro, bairro: data.bairro})); 
                        if (autoFocusNumber && document.getElementById('input-number')) document.getElementById('input-number').focus();
                    } else { showAlert("Erro", "CEP n√£o encontrado.", "error"); }
                } catch(e) { showAlert("Erro", "Erro ao buscar CEP.", "error"); }
                finally { setCepLoading(false); }
            };

            useEffect(() => {
                if (form.cep.length >= 8 && form.number) {
                    setDel(p => ({ ...p, loading: true }));
                    if (typingTimer) clearTimeout(typingTimer);
                    const timer = setTimeout(() => calculateFinalShipping(), 1000);
                    setTypingTimer(timer);
                }
            }, [form.number, form.cep]);

            const calculateFinalShipping = async () => {
                const bairroMatch = neighborhoods.find(n => n.name.toLowerCase().trim() === form.bairro.toLowerCase().trim());
                if (bairroMatch) { setDel({ fee: parseFloat(bairroMatch.price), method: 'bairro_fixo' }); return; }
                
                try {
                    const query = `${form.address}, ${form.number}, Cascavel, PR, Brazil`;
                    const res = await fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(query)}&limit=1`);
                    const data = await res.json();
                    if(data.length > 0) {
                        const lat = parseFloat(data[0].lat);
                        const lon = parseFloat(data[0].lon);
                        const osrmUrl = `https://router.project-osrm.org/route/v1/driving/${settings.restLng},${settings.restLat};${lon},${lat}?overview=false`;
                        const rRes = await fetch(osrmUrl);
                        const rData = await rRes.json();
                        if (rData.routes && rData.routes.length > 0) {
                            const km = (rData.routes[0].distance / 1000).toFixed(1);
                            const fee = Math.max(5, km * settings.pricePerKm);
                            setDel({ fee, km, lat, lon, method: 'gps_auto' });
                        } else { fallbackCalc(lat, lon); }
                    } else { setDel({ fee: 0, method: 'erro' }); showAlert("Aten√ß√£o", "Rota n√£o encontrada. Verifique o n√∫mero.", 'alert'); }
                } catch(e) { setDel({ fee: 0, method: 'erro' }); }
            };

            const fallbackCalc = (lat, lon) => {
                const R=6371; const dLat=(lat-settings.restLat)*Math.PI/180; const dLon=(lon-settings.restLng)*Math.PI/180;
                const a = Math.sin(dLat/2)*Math.sin(dLat/2) + Math.cos(settings.restLat*Math.PI/180)*Math.cos(lat*Math.PI/180) * Math.sin(dLon/2)*Math.sin(dLon/2);
                const km = (R*2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a)) * 1.3).toFixed(1);
                const fee = Math.max(5, km * settings.pricePerKm);
                setDel({ fee, km, lat, lon, method: 'fallback' });
            };

            const handleCouponChange = (e) => { setCouponCode(e.target.value.replace(/\s/g, '').toUpperCase()); };
            const applyCoupon = async () => {
                if(!couponCode) return;
                const q = await getCol('coupons').where('code', '==', couponCode.toUpperCase()).where('active', '==', true).get();
                if(q.empty) return showAlert("Erro", "Cupom inv√°lido", "error");
                const d = q.docs[0].data();
                if(d.limit && (d.usageCount || 0) >= d.limit) return showAlert("Erro", "Cupom esgotado", "error");
                setAppliedCoupon({ id: q.docs[0].id, ...d }); showAlert("Sucesso", "Cupom aplicado!", "success");
            };

            const getDiscount = () => {
                if(!appliedCoupon) return 0;
                if(appliedCoupon.type === 'fixed') return parseFloat(appliedCoupon.value);
                if(appliedCoupon.type === 'percent') {
                    const d = totalItems * (parseFloat(appliedCoupon.value)/100);
                    return appliedCoupon.maxDiscount ? Math.min(d, parseFloat(appliedCoupon.maxDiscount)) : d;
                }
                return 0;
            };
            
            const discount = getDiscount();
            const total = Math.max(0, totalItems + del.fee - discount);

            const handlePix = async () => {
                if (!form.name || !form.phone || !form.cep || !form.number) { 
                    showAlert("Aten√ß√£o", "Preencha todos os dados de entrega antes de gerar o Pix.", "alert"); 
                    return; 
                }
                showLoading("Gerando Pix Autom√°tico...");
                try {
                    const mpUrl = "https://api.mercadopago.com/v1/payments";
                    const proxyUrl = "https://corsproxy.io/?" + encodeURIComponent(mpUrl);
                    const payload = {
                        transaction_amount: Number(total.toFixed(2)),
                        description: `Pedido ${settings.appName} - ${form.phone}`,
                        payment_method_id: "pix",
                        payer: { email: "cliente@email.com", first_name: form.name.split(' ')[0], last_name: form.name.split(' ').slice(1).join(' ') || 'Cliente' }
                    };
                    const res = await fetch(proxyUrl, {
                        method: "POST",
                        headers: { "Authorization": `Bearer ${settings.mercadoPagoToken}`, "Content-Type": "application/json", "X-Idempotency-Key": Date.now().toString() },
                        body: JSON.stringify(payload)
                    });
                    const data = await res.json();
                    if (data.point_of_interaction) { setPixData(data); closeModal(); } 
                    else { throw new Error("Resposta inv√°lida do MP"); }
                } catch (e) { closeModal(); showAlert("Erro", "N√£o foi poss√≠vel gerar o Pix.", "error"); }
            };

            const finishOrder = async () => {
                if(!form.name || !form.phone || !form.address || !form.number) return showAlert("Ops", "Preencha todos os campos de entrega.");
                if(!payMethod) return showAlert("Ops", "Selecione o pagamento.");
                if(del.fee === 0 && del.method !== 'bairro_fixo') return showAlert("Aten√ß√£o", "Aguardando c√°lculo do frete...", "alert");
                
                showLoading("Enviando...");
                try {
                    const ref = await getCol('orders').add({ customer: form, items: cart, totals: { sub: totalItems, del: del.fee, discount, total: total }, payment: { method: payMethod, change: change }, coupon: appliedCoupon ? appliedCoupon.code : null, createdAt: new Date().toISOString(), status: 'pendente' });
                    if(appliedCoupon) getCol('coupons').doc(appliedCoupon.id).update({ usageCount: firebase.firestore.FieldValue.increment(1) });
                    
                    const cleanPhone = form.phone.replace(/\D/g,'');
                    const cRef = getCol('customers'); 
                    const cSnap = await cRef.where('phoneRaw','==',cleanPhone).limit(1).get();
                    if(cSnap.empty) cRef.add({ ...form, phoneRaw: cleanPhone, lastOrder: new Date().toISOString(), orderCount: 1 });
                    else cSnap.docs[0].ref.update({ ...form, lastOrder: new Date().toISOString(), orderCount: firebase.firestore.FieldValue.increment(1) });

                    let msg = `*NOVO PEDIDO DE ${form.name.toUpperCase()}*\nüìç ${form.address}, ${form.number} - ${form.bairro}\n${form.complement ? `Obs: ${form.complement}\n` : ''}\n`; 
                    cart.forEach(i => msg += `${i.quantity}x ${i.name}\n`); 
                    if(appliedCoupon) msg += `\nüéü Cupom: ${appliedCoupon.code}`;
                    msg += `\nüõµ Entrega: ${formatMoney(del.fee)}`;
                    msg += `\nüí∞ *Total: ${formatMoney(total)}*`;
                    msg += `\nüí≥ Pag: ${payMethod} ${change ? `(Troco p/ ${change})` : ''}`;
                    
                    const trackLink = window.location.origin + window.location.pathname.replace('index.html', 'acompanhar.html') + '?fone=' + cleanPhone;
                    msg += `\n\nüõµ *ACOMPANHE SEU PEDIDO:*\n${trackLink}`;
                    
                    const whatsNumber = (settings.whatsappNumber || "5545988166885").replace(/\D/g, '');
                    closeModal(); setCart([]); 
                    
                    // 1. Redireciona
                    window.location.href = `acompanhar.html?fone=${cleanPhone}`;
                    
                    // 2. Abre WhatsApp (Sem _blank para tentar for√ßar o app)
                    window.open(`https://wa.me/${whatsNumber}?text=${encodeURIComponent(msg)}`);
                    
                } catch(e) { closeModal(); showAlert("Erro", "Erro ao enviar: " + e.message); }
            };

            const copyPix = () => {
                if(pixData?.point_of_interaction?.transaction_data?.qr_code) {
                    navigator.clipboard.writeText(pixData.point_of_interaction.transaction_data.qr_code);
                    showAlert("Sucesso", "C√≥digo Pix copiado!", "success");
                }
            };

            return (
                <div className="pt-8">
                    <button onClick={onBack} className="mb-4 text-gray-500 font-bold flex items-center gap-2 text-sm"><i className="fa-solid fa-arrow-left"></i> Voltar</button>
                    <div className={`bg-white shadow-xl overflow-hidden ${border}`}>
                        <div className="bg-gray-50 p-6 border-b">
                            <h2 className="text-2xl font-bold text-gray-800">Seu Pedido</h2>
                            <div className="mt-4 space-y-3">{cart.map(i => (<div key={i.id} className="flex justify-between items-center text-sm"><div className="flex items-center gap-3"><span className="bg-gray-200 text-gray-700 w-6 h-6 rounded flex items-center justify-center font-bold text-xs">{i.quantity}</span><span className="text-gray-600">{i.name}</span></div><div className="flex items-center gap-3"><span className="font-medium">{formatMoney(i.price * i.quantity)}</span><button onClick={()=>setCart(p=>p.filter(x=>x.id!==i.id))} className="text-red-400 text-xs"><i className="fa-solid fa-trash"></i></button></div></div>))}</div>
                        </div>
                        <div className="p-6 space-y-6">
                            
                            {/* ENTREGA */}
                            <div className="space-y-3">
                                <h3 className="font-bold text-gray-800 border-l-4 pl-3" style={{borderColor: settings.themeColor}}>Entrega</h3>
                                
                                {/* 1. TELEFONE (Topo) */}
                                <input type="tel" placeholder="WhatsApp (45...)" className={`border p-3 bg-gray-50 w-full text-lg font-bold ${border}`} value={form.phone} onChange={handlePhoneChange} onBlur={()=>check(form.phone)} />
                                
                                {/* 2. NOME */}
                                <input placeholder="Seu Nome" className={`border p-3 bg-gray-50 w-full ${border}`} value={form.name} onChange={e=>setForm({...form, name:e.target.value})} />
                                
                                {/* 3. CEP e NUMERO (Lado a Lado) */}
                                <div className="flex gap-2">
                                    <div className="relative flex-1">
                                        <input type="tel" placeholder="CEP (85803...)" className={`border p-3 bg-gray-50 w-full font-bold ${border}`} value={form.cep} onChange={handleCepChange} maxLength={9} />
                                        {cepLoading && <i className="fa-solid fa-spinner fa-spin absolute right-3 top-4 text-gray-400"></i>}
                                    </div>
                                    <input placeholder="N¬∫" type="tel" id="input-number" className={`border p-3 bg-gray-50 w-24 text-center font-bold ${border}`} value={form.number} onChange={e=>setForm({...form, number:e.target.value})} />
                                </div>

                                {/* 4. ENDERE√áO e BAIRRO (Abaixo) */}
                                <div className="space-y-2">
                                    <input placeholder="Endere√ßo (Preenchido pelo CEP)" className={`border p-3 bg-gray-100 text-gray-500 w-full ${border}`} value={form.address} readOnly />
                                    <input placeholder="Bairro" className={`border p-3 bg-gray-100 text-gray-500 w-full ${border}`} value={form.bairro} readOnly />
                                </div>

                                {/* 5. COMPLEMENTO */}
                                <input placeholder="Complemento / Ponto de Ref." className={`border p-3 bg-gray-50 w-full ${border}`} value={form.complement} onChange={e=>setForm({...form, complement:e.target.value})} />
                            </div>

                            {/* PAGAMENTO */}
                            <div className="space-y-3">
                                <h3 className="font-bold text-gray-800 border-l-4 pl-3" style={{borderColor: settings.themeColor}}>Pagamento</h3>
                                
                                {/* Cupons */}
                                <div className="flex gap-2">
                                    <input placeholder="C√ìDIGO CUPOM" className={`border p-2 flex-1 uppercase text-sm ${border}`} value={couponCode} onChange={handleCouponChange} />
                                    <button onClick={applyCoupon} className={`px-4 text-white text-xs font-bold ${border}`} style={theme}>APLICAR</button>
                                </div>
                                {appliedCoupon && <div className="bg-green-100 text-green-700 p-2 text-xs font-bold rounded flex justify-between"><span>Cupom Aplicado: {appliedCoupon.code}</span><span>- {formatMoney(discount)}</span></div>}

                                <div className="grid grid-cols-2 gap-2">
                                    {['Dinheiro', 'Pix'].map(m => (
                                        <button key={m} onClick={() => { setPayMethod(m); if(m==='Pix' && settings.mercadoPagoToken) handlePix(); else setPixData(null); }} 
                                            className={`p-3 border text-xs font-bold transition ${border} ${payMethod === m ? 'bg-gray-800 text-white border-gray-800' : 'bg-white text-gray-600 border-gray-200'}`} style={payMethod===m?theme:{}}>
                                            {m}
                                        </button>
                                    ))}
                                    <button onClick={() => setPayMethod('Cart√£o Cr√©dito/D√©bito')} className={`p-3 border text-xs font-bold transition col-span-2 ${border} ${payMethod === 'Cart√£o Cr√©dito/D√©bito' ? 'bg-gray-800 text-white border-gray-800' : 'bg-white text-gray-600 border-gray-200'}`} style={payMethod==='Cart√£o Cr√©dito/D√©bito'?theme:{}}>
                                        Cart√£o Cr√©dito/D√©bito
                                    </button>
                                </div>
                                {payMethod === 'Dinheiro' && <input type="number" placeholder="Troco para quanto?" className={`w-full p-3 border bg-yellow-50 ${border}`} value={change} onChange={e=>setChange(e.target.value)} />}
                                {payMethod === 'Pix' && !pixData && !settings.mercadoPagoToken && <div className="text-xs text-blue-600 bg-blue-50 p-2 rounded">Chave Pix ser√° enviada na mensagem.</div>}
                                {pixData && (
                                    <div className={`bg-teal-50 p-4 border border-teal-200 text-center ${border}`}>
                                        <img src={`data:image/png;base64,${pixData.point_of_interaction.transaction_data.qr_code_base64}`} className="w-40 h-40 mx-auto mix-blend-multiply" />
                                        <textarea className="w-full text-xs p-2 mt-2 border rounded" readOnly value={pixData.point_of_interaction.transaction_data.qr_code} onClick={(e)=>e.target.select()}></textarea>
                                        <button onClick={copyPix} className="w-full mt-2 py-2 bg-teal-600 text-white font-bold rounded hover:bg-teal-700 transition text-sm">
                                            <i className="fa-regular fa-copy mr-1"></i> Copiar C√≥digo Pix
                                        </button>
                                        <p className="text-xs text-teal-700 mt-2">Copie e cole no aplicativo do seu banco</p>
                                    </div>
                                )}
                            </div>

                            {/* TOTAIS */}
                            <div className="bg-gray-100 p-4 rounded-xl space-y-1 text-sm">
                                <div className="flex justify-between text-gray-600"><span>Subtotal</span><span>{formatMoney(totalItems)}</span></div>
                                <div className="flex justify-between text-gray-600"><span>Entrega {del.km > 0 ? `(${del.km}km)` : ''}</span><span className="font-bold">{del.loading ? 'Calculando...' : formatMoney(del.fee)}</span></div>
                                {discount > 0 && <div className="flex justify-between text-green-600 font-bold"><span>Desconto</span><span>- {formatMoney(discount)}</span></div>}
                                <div className="flex justify-between text-xl font-bold text-gray-800 border-t pt-2 mt-2" style={{color: settings.themeColor}}><span>Total</span><span>{formatMoney(total)}</span></div>
                            </div>

                            <button onClick={finishOrder} disabled={del.loading || (del.fee===0 && del.method!=='bairro_fixo')} className={`w-full py-4 bg-green-600 hover:bg-green-700 text-white font-bold shadow-lg transition transform active:scale-95 flex items-center justify-center gap-2 disabled:opacity-50 ${border}`} style={{backgroundColor: settings.cartColor}}>
                                <span>Enviar Pedido</span><i className="fa-brands fa-whatsapp"></i>
                            </button>
                        </div>
                    </div>
                </div>
            );
        };

        const OrderStatusView = ({ orderId, onBack, theme, border }) => {
            const [order, setOrder] = useState(null);
            useEffect(() => { const unsub = getCol('orders').doc(orderId).onSnapshot(d => { if(d.exists) setOrder({ id: d.id, ...d.data() }); }); return () => unsub(); }, [orderId]);
            if(!order) return <div className="text-center py-10"><div className="loader border-gray-400"></div></div>;
            const steps = [{ s: 'pendente', label: 'Recebido' }, { s: 'confirmado', label: 'Confirmado' }, { s: 'preparando', label: 'Preparando' }, { s: 'enviado', label: 'Saiu p/ Entrega' }, { s: 'entregue', label: 'Entregue' }];
            const currentIdx = steps.findIndex(st => st.s === order.status) || 0;
            const progress = (currentIdx / (steps.length - 1)) * 100;

            return (
                <div className="pt-8 min-h-screen">
                    <div className={`bg-white shadow-xl overflow-hidden mb-6 relative ${border}`}>
                        <div className="p-8 text-center text-white relative overflow-hidden" style={theme}><div className="absolute inset-0 bg-black/10"></div><div className="relative z-10"><div className="text-sm opacity-80 mb-2">PEDIDO #{order.id.slice(-4)}</div><h2 className="text-3xl font-chewy mb-2 animate-pulse">{steps[currentIdx].label}</h2></div></div>
                        <div className="p-8 bg-gray-50"><div className="relative pl-8 space-y-8"><div className="step-line absolute left-[15px] top-2 bottom-2 w-1 bg-gray-200"></div><div className="step-line absolute left-[15px] top-2 w-1 transition-all duration-1000" style={{height: `${progress}%`, ...theme}}></div>{steps.map((st, i) => { const active = i <= currentIdx; return (<div key={st.s} className={`step-item flex items-center gap-4 ${active ? 'opacity-100' : 'opacity-40 grayscale'}`}><div className={`w-8 h-8 rounded-full flex items-center justify-center text-white z-10 shadow-md transition-all duration-500 ${active ? 'scale-110' : 'scale-100 bg-gray-300'}`} style={active ? theme : {}}><i className="fa-solid fa-check text-xs"></i></div><div className="font-bold text-gray-800">{st.label}</div></div>); })}</div></div>
                    </div>
                    <button onClick={() => { localStorage.removeItem('fritzza_last_order'); onBack(); }} className={`w-full py-4 bg-white border-2 text-gray-500 font-bold hover:bg-gray-50 ${border}`}>Novo Pedido</button>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>


